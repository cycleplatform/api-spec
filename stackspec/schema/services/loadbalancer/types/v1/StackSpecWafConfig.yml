title: StackSpecWafConfig
type: object
description: Additional configuration options for the web application firewall.
required:
  - rules
properties:
  rules:
    oneOf:
      - type: array
        items:
          oneOf:
            - type: object
              required:
                - description
                - skip
                - type
                - conditions
              properties:
                description:
                  oneOf:
                    - type: string
                    - $ref: ../../../../StackVariable.yml
                skip:
                  oneOf:
                    - type: boolean
                    - $ref: ../../../../StackVariable.yml
                type:
                  oneOf:
                    - type: string
                      enum:
                        - allow
                        - deny
                    - $ref: ../../../../StackVariable.yml
                conditions:
                  oneOf:
                    - type: array
                      items:
                        oneOf:
                          - type: object
                            required:
                              - type
                              - operator
                              - value
                            properties:
                              type:
                                oneOf:
                                  - type: string
                                    enum:
                                      - ip-match
                                      - geo-match
                                      - url-match
                                      - method-match
                                      - header-match
                                  - $ref: ../../../../StackVariable.yml
                              operator:
                                oneOf:
                                  - type: string
                                    enum:
                                      - "=="
                                      - "!="
                                      - ">"
                                      - "<"
                                      - ">="
                                      - "<="
                                  - $ref: ../../../../StackVariable.yml
                              value:
                                oneOf:
                                  - type: string
                                  - $ref: ../../../../StackVariable.yml
                          - $ref: ../../../../StackVariable.yml
                    - $ref: ../../../../StackVariable.yml
            - $ref: ../../../../StackVariable.yml
      - $ref: ../../../../StackVariable.yml
